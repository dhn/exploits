# CVE-2019-10149 - Exim 4.87 < 4.91 LPE

> Exim is vulnerable by default since version 4.87 (released on April 6,
> 2016), when #ifdef EXPERIMENTAL_EVENT became #ifndef DISABLE_EVENT; and
> older versions may also be vulnerable if EXPERIMENTAL_EVENT was enabled
> manually. Surprisingly, this vulnerability was fixed in version 4.92
> (released on February 10, 2019):

## Vulnerable environment

To setup a vulnerable environment for your test you will need [Docker](https://docker.com)
installed, and just run the following command:

	docker build -t vuln/cve-2019-10149 .
	docker run --rm -it vuln/cve-2019-10149

And it will spawn a interactive shell with low user privileges.

## Exploit

<p align="center">
	<img src="https://github.com/dhn/exploits/blob/master/CVE-2019-10149/poc.gif">
</p>

## Credits

The vulnerability was discovered by [Qualys](https://www.qualys.com/2019/06/05/cve-2019-10149/return-wizard-rce-exim.txt).

## Disclaimer

This or previous program is for Educational purpose **ONLY**. Do not use it without
permission. The usual disclaimer applies, especially the fact that me (dhn) is
not liable for any damages caused by direct or indirect use of the information
or functionality provided by these programs. The author or any Internet provider
bears **NO** responsibility for content or misuse of these programs or any
derivatives thereof. By using these programs you accept the fact that any damage
(dataloss, system crash, system compromise, etc.) caused by the use of these
programs is not dhn's responsibility.
